const Italian1 = [
    {
        question: "Cosa significa 'ciao' in inglese? (Italian)",
        answers: [
            {text: "Goodbye", correct: false},
            {text: "Hello", correct: true},
            {text: "Thank you", correct: false},
            {text: "Excuse me", correct: false}
        ]
    },
    {
        question: "Qual è il colore del sole?",
        answers: [
            {text: "Blu", correct: false},
            {text: "Rosso", correct: false},
            {text: "Giallo", correct: true},
            {text: "Verde", correct: false}
        ]
    },
    {
        question: "Quale animale fa 'bau'?",
        answers: [
            {text: "Gatto", correct: false},
            {text: "Cane", correct: true},
            {text: "Pesce", correct: false},
            {text: "Uccello", correct: false}
        ]
    },
    {
        question: "Come si dice 'grazie' in inglese?",
        answers: [
            {text: "Hello", correct: false},
            {text: "Goodbye", correct: false},
            {text: "Please", correct: false},
            {text: "Thank you", correct: true}
        ]
    }
];

const Italian2 = [
    {
        question: "Qual è la capitale dell'Italia? (Italian)",
        answers: [
            {text: "Milano", correct: false},
            {text: "Firenze", correct: false},
            {text: "Roma", correct: true},
            {text: "Napoli", correct: false}
        ]
    },
    {
        question: "Chi dipinse la 'Gioconda'?",
        answers: [
            {text: "Michelangelo", correct: false},
            {text: "Leonardo da Vinci", correct: true},
            {text: "Raffaello Sanzio", correct: false},
            {text: "Donatello", correct: false}
        ]
    },
    {
        question: "Qual è il fiume più lungo del mondo?",
        answers: [
            {text: "Nilo", correct: true},
            {text: "Mississippi", correct: false},
            {text: "Amazonas", correct: false},
            {text: "Danubio", correct: false}
        ]
    },
    {
        question: "Chi scrisse 'La Divina Commedia'?",
        answers: [
            {text: "Petrarca", correct: false},
            {text: "Boccaccio", correct: false},
            {text: "Dante Alighieri", correct: true},
            {text: "Machiavelli", correct: false}
        ]
    }
];

const Italian3 = [
    {
        question: "Quale pianeta è conosciuto come il pianeta rosso? (Italian)",
        answers: [
            {text: "Venere", correct: false},
            {text: "Marte", correct: true},
            {text: "Giove", correct: false},
            {text: "Saturno", correct: false}
        ]
    },
    {
        question: "Chi scrisse 'Romeo e Giulietta'?",
        answers: [
            {text: "William Shakespeare", correct: true},
            {text: "Jane Austen", correct: false},
            {text: "Charles Dickens", correct: false},
            {text: "Leo Tolstoy", correct: false}
        ]
    },
    {
        question: "Qual è l'animale nazionale dell'Australia?",
        answers: [
            {text: "Canguro", correct: true},
            {text: "Koala", correct: false},
            {text: "Emù", correct: false},
            {text: "Wombat", correct: false}
        ]
    },
    {
        question: "Chi dipinse 'La nascita di Venere'?",
        answers: [
            {text: "Sandro Botticelli", correct: true},
            {text: "Leonardo da Vinci", correct: false},
            {text: "Michelangelo", correct: false},
            {text: "Raffaello Sanzio", correct: false}
        ]
    }
];

const French1 = [
    {
        question: "Quel est le nom de la capitale de la France? (French)",
        answers: [
            {text: "Londres", correct: false},
            {text: "Paris", correct: true},
            {text: "Berlin", correct: false},
            {text: "Madrid", correct: false}
        ]
    },
    {
        question: "Combien de continents y a-t-il sur la Terre?",
        answers: [
            {text: "Cinq", correct: true},
            {text: "Trois", correct: false},
            {text: "Sept", correct: false},
            {text: "Neuf", correct: false}
        ]
    },
    {
        question: "Quelle est la couleur du ciel pendant la nuit?",
        answers: [
            {text: "Bleu", correct: false},
            {text: "Noir", correct: true},
            {text: "Rouge", correct: false},
            {text: "Blanc", correct: false}
        ]
    },
    {
        question: "Qui a peint la Joconde?",
        answers: [
            {text: "Pablo Picasso", correct: false},
            {text: "Leonardo da Vinci", correct: true},
            {text: "Vincent van Gogh", correct: false},
            {text: "Michel-Ange", correct: false}
        ]
    }
];

const French2 = [
    {
        question: "Quel est le plus grand océan du monde? (French)",
        answers: [
            {text: "Océan Atlantique", correct: false},
            {text: "Océan Indien", correct: false},
            {text: "Océan Pacifique", correct: true},
            {text: "Océan Arctique", correct: false}
        ]
    },
    {
        question: "Quelle est la capitale de l'Italie?",
        answers: [
            {text: "Rome", correct: true},
            {text: "Paris", correct: false},
            {text: "Madrid", correct: false},
            {text: "Berlin", correct: false}
        ]
    },
    {
        question: "Quelle est la planète la plus proche du Soleil?",
        answers: [
            {text: "Vénus", correct: false},
            {text: "Jupiter", correct: false},
            {text: "Mercure", correct: true},
            {text: "Mars", correct: false}
        ]
    },
    {
        question: "Quel est le nom du plus grand désert du monde?",
        answers: [
            {text: "Désert du Sahara", correct: true},
            {text: "Désert de Gobi", correct: false},
            {text: "Désert d'Atacama", correct: false},
            {text: "Désert du Kalahari", correct: false}
        ]
    }
];

const French3 = [
    {
        question: "Quelle est la distance approximative entre la Terre et la Lune? (French)",
        answers: [
            {text: "10 000 km", correct: false},
            {text: "100 000 km", correct: false},
            {text: "384 400 km", correct: true},
            {text: "1 000 000 km", correct: false}
        ]
    },
    {
        question: "Qui a écrit 'Les Misérables'?",
        answers: [
            {text: "Victor Hugo", correct: true},
            {text: "Emile Zola", correct: false},
            {text: "Gustave Flaubert", correct: false},
            {text: "Albert Camus", correct: false}
        ]
    },
    {
        question: "Quel est le plus haut sommet du monde?",
        answers: [
            {text: "Mont Everest", correct: true},
            {text: "Mont Kilimandjaro", correct: false},
            {text: "Mont Blanc", correct: false},
            {text: "Mont McKinley", correct: false}
        ]
    },
    {
        question: "Quel est le symbole chimique de l'eau?",
        answers: [
            {text: "O2", correct: false},
            {text: "H2O", correct: true},
            {text: "CO2", correct: false},
            {text: "N2", correct: false}
        ]
    }
];

const Spanish1 = [
    {
        question: "¿Cuál es el nombre de la capital de España? (Spanish)",
        answers: [
            {text: "Roma", correct: false},
            {text: "París", correct: false},
            {text: "Madrid", correct: true},
            {text: "Londres", correct: false}
        ]
    },
    {
        question: "¿Cuántos días tiene el mes de febrero en un año bisiesto?",
        answers: [
            {text: "28", correct: false},
            {text: "30", correct: false},
            {text: "29", correct: true},
            {text: "31", correct: false}
        ]
    },
    {
        question: "¿Qué río atraviesa la ciudad de París?",
        answers: [
            {text: "Támesis", correct: false},
            {text: "Danubio", correct: false},
            {text: "Sena", correct: true},
            {text: "Rhin", correct: false}
        ]
    },
    {
        question: "¿Quién pintó 'La Persistencia de la Memoria'?",
        answers: [
            {text: "Pablo Picasso", correct: false},
            {text: "Vincent van Gogh", correct: false},
            {text: "Salvador Dalí", correct: true},
            {text: "Leonardo da Vinci", correct: false}
        ]
    }
];

const Spanish2 = [
    {
        question: "¿Cuál es el país más grande del mundo en términos de área terrestre? (Spanish)",
        answers: [
            {text: "Estados Unidos", correct: false},
            {text: "Canadá", correct: false},
            {text: "Rusia", correct: true},
            {text: "China", correct: false}
        ]
    },
    {
        question: "¿Quién escribió 'Don Quijote de la Mancha'?",
        answers: [
            {text: "Miguel de Cervantes", correct: true},
            {text: "Gabriel García Márquez", correct: false},
            {text: "Jorge Luis Borges", correct: false},
            {text: "Pablo Neruda", correct: false}
        ]
    },
    {
        question: "¿Cuál es el océano más grande del mundo?",
        answers: [
            {text: "Océano Índico", correct: false},
            {text: "Océano Atlántico", correct: false},
            {text: "Océano Pacífico", correct: true},
            {text: "Océano Antártico", correct: false}
        ]
    },
    {
        question: "¿Quién fue el primer presidente de los Estados Unidos?",
        answers: [
            {text: "George Washington", correct: true},
            {text: "Thomas Jefferson", correct: false},
            {text: "Abraham Lincoln", correct: false},
            {text: "John F. Kennedy", correct: false}
        ]
    }
];

const Spanish3 = [
    {
        question: "¿En qué año comenzó la Primera Guerra Mundial? (Spanish)",
        answers: [
            {text: "1914", correct: true},
            {text: "1918", correct: false},
            {text: "1939", correct: false},
            {text: "1945", correct: false}
        ]
    },
    {
        question: "¿Cuál es el resultado de sumar los ángulos internos de un triángulo?",
        answers: [
            {text: "180 grados", correct: true},
            {text: "90 grados", correct: false},
            {text: "360 grados", correct: false},
            {text: "270 grados", correct: false}
        ]
    },
    {
        question: "¿Quién fue el primer astronauta en caminar sobre la Luna?",
        answers: [
            {text: "Buzz Aldrin", correct: false},
            {text: "Yuri Gagarin", correct: false},
            {text: "Neil Armstrong", correct: true},
            {text: "Alan Shepard", correct: false}
        ]
    },
    {
        question: "¿Cuál es el río más largo del mundo?",
        answers: [
            {text: "Nilo", correct: false},
            {text: "Amazonas", correct: true},
            {text: "Misisipi", correct: false},
            {text: "Yangtsé", correct: false}
        ]
    }
];

const German1 = [
    {
        question: "Wie heißt die Hauptstadt von Deutschland? (German)",
        answers: [
            {text: "Paris", correct: false},
            {text: "Berlin", correct: true},
            {text: "London", correct: false},
            {text: "Rom", correct: false}
        ]
    },
    {
        question: "Wie viele Kontinente gibt es auf der Erde?",
        answers: [
            {text: "Fünf", correct: true},
            {text: "Drei", correct: false},
            {text: "Sieben", correct: false},
            {text: "Neun", correct: false}
        ]
    },
    {
        question: "Was ist die Hauptfarbe des Himmels bei Tag?",
        answers: [
            {text: "Schwarz", correct: false},
            {text: "Grau", correct: false},
            {text: "Blau", correct: true},
            {text: "Weiß", correct: false}
        ]
    },
    {
        question: "Wer hat die Mona Lisa gemalt?",
        answers: [
            {text: "Pablo Picasso", correct: false},
            {text: "Leonardo da Vinci", correct: true},
            {text: "Vincent van Gogh", correct: false},
            {text: "Michelangelo", correct: false}
        ]
    }
];

const German2 = [
    {
        question: "Wie nennt man die kleinste Einheit einer Substanz, die alle Eigenschaften dieser Substanz hat? (German)",
        answers: [
            {text: "Atom", correct: true},
            {text: "Molekül", correct: false},
            {text: "Element", correct: false},
            {text: "Ion", correct: false}
        ]
    },
    {
        question: "Was ist die Hauptzutat in der italienischen Speise 'Pizza'?",
        answers: [
            {text: "Fleisch", correct: false},
            {text: "Käse", correct: true},
            {text: "Gemüse", correct: false},
            {text: "Teig", correct: false}
        ]
    },
    {
        question: "Welche Sprache spricht man in Russland?",
        answers: [
            {text: "Englisch", correct: false},
            {text: "Französisch", correct: false},
            {text: "Russisch", correct: true},
            {text: "Spanisch", correct: false}
        ]
    },
    {
        question: "Wie nennt man die Wissenschaft von den Sternen?",
        answers: [
            {text: "Astronomie", correct: true},
            {text: "Biologie", correct: false},
            {text: "Geographie", correct: false},
            {text: "Chemie", correct: false}
        ]
    }
];

const German3 = [
    {
        question: "Wie nennt man die Hauptstadt von Frankreich? (German)",
        answers: [
            {text: "Rom", correct: false},
            {text: "Berlin", correct: false},
            {text: "Madrid", correct: false},
            {text: "Paris", correct: true}
        ]
    },
    {
        question: "Was ist die höchste Zahl auf dem üblichen Zifferblatt einer Armbanduhr?",
        answers: [
            {text: "10", correct: false},
            {text: "12", correct: true},
            {text: "24", correct: false},
            {text: "20", correct: false}
        ]
    },
    {
        question: "Wie nennt man eine Gruppe von Fischen?",
        answers: [
            {text: "Schwarm", correct: true},
            {text: "Herde", correct: false},
            {text: "Rudel", correct: false},
            {text: "Kolonie", correct: false}
        ]
    },
    {
        question: "Was ist die Hauptstadt von Italien?",
        answers: [
            {text: "Berlin", correct: false},
            {text: "Madrid", correct: false},
            {text: "Paris", correct: false},
            {text: "Rom", correct: true}
        ]
    }
];

const setTableNames = ["firstSetComplete", "secondSetComplete", "thirdSetComplete"];

const questionElement = document.getElementById("question");
const answerButtons = document.getElementById("answer-buttons");
const nextButton = document.getElementById("btnNext");

let currentQuestionIndex = 0;
let score = 0;
let currentQuestions = [];
let currentSetIndex = 0;
let currentSetTableName;
var challengeName;

function setTableNameIndex(setTableNameNbr) {
    if ((setTableNameNbr - 1) === 0) {
        currentSetTableName = setTableNames[setTableNameNbr - 1];
    } else if ((setTableNameNbr - 1) === 1) {
        currentSetTableName = setTableNames[setTableNameNbr - 1];
    } else if ((setTableNameNbr - 1) === 2) {
        currentSetTableName = setTableNames[setTableNameNbr - 1];
    }
}

function loadChallengeSet(questions) {
    var questionLan = questions[0].question;
    const parts = questionLan.split('(');
    if (parts.length > 1) {
        const languageName = parts[1].replace(')', '');
        console.log(languageName);
        challengeName = languageName;
    }
    currentQuestions = questions;
    currentQuestionIndex = 0;
    score = 0;
    nextButton.innerHtml = "Next";
    showQuestion();
}

 function showQuestion() {
        resetState();
        let currentQuestion = currentQuestions[currentQuestionIndex];
        let questionNbr = currentQuestionIndex + 1;
        questionElement.innerHTML = questionNbr + ". " + currentQuestion.question;

        currentQuestion.answers.forEach(answer => {
            const button = document.createElement("button");
            button.innerHTML = answer.text;
            button.classList.add("btnAnswer");
            answerButtons.appendChild(button);
            if (answer.correct) {
                button.dataset.correct = answer.correct;
            }
            button.addEventListener("click", selectAnswer);
        });
    }



function resetState() {
    nextButton.style.display = "none";
    nextButton.innerHTML = "Next";
    while (answerButtons.firstChild) {
        answerButtons.removeChild(answerButtons.firstChild);
    }
}

function selectAnswer(e) {
    const selectedBtn = e.target;
    const isCorrect = selectedBtn.dataset.correct === "true";
    if (isCorrect) {
        selectedBtn.classList.add("correct");
        score++;
    } else {
        selectedBtn.classList.add("incorrect");
    }
    Array.from(answerButtons.children).forEach(button => {
        if (button.dataset.correct === "true") {
            button.classList.add("correct");
        }
        button.disabled = true;
    });
    nextButton.style.display = "block";
}

function showScore() {
    resetState();
    if (score === currentQuestions.length) {
        $.ajax({
            url: 'ChallengeController',
            method: 'POST',
            data: {columnName: currentSetTableName,
                challenge_name: challengeName
            },
            success: function (response) {
                if (response.success) {
                    location.reload();
                } else {
                    alert('Failed to update challenge status');
                }
            },
            error: function (xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    } else {
        questionElement.innerHTML = `You scored ${score} out of 4!`;
    }
    nextButton.innerHTML = "Restart the challenge";
    nextButton.style.display = "block";
}

function handleNextButton() {
    currentQuestionIndex++;
    if (currentQuestionIndex < currentQuestions.length) {
        showQuestion();
    } else {
        showScore();
    }
}

nextButton.addEventListener("click", () => {
    if (currentQuestionIndex < Italian1.length) {
        handleNextButton();
    } else {
        loadChallengeSet(currentQuestions);
    }
});